<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vampuca AI Graphic Novel Player</title>
    <meta name="description" content="Vampuca AI interactive graphic novel player with 21 immersive video chapters">
    <meta property="og:title" content="Vampuca AI Graphic Novel">
    <meta property="og:description" content="Experience the interactive graphic novel with seamless video navigation">
    <meta property="og:type" content="website">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: black;
            color: white;
            overflow: hidden;
            user-select: none;
        }

        .player-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: black;
        }

        .studio-branding {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 50;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .studio-brand-block {
            background: rgba(0,0,0,0.7);
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255,133,51,0.2);
        }

        .dropdown-button-container {
            background: rgba(0,0,0,0.7);
            padding: 0.5rem;
            border-radius: 0.5rem;
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255,133,51,0.2);
        }

        .studio-name {
            color: hsl(14,100%,60%);
            font-weight: 700;
            font-size: 1.125rem;
            letter-spacing: 0.05em;
            text-shadow: 0 0 10px rgba(255,133,51,0.3);
        }

        .dropdown-button {
            background: none;
            border: none;
            color: hsl(14,100%,60%);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 0.25rem;
            transition: all 0.2s ease;
        }

        .dropdown-button:hover {
            color: white;
            background: rgba(255,133,51,0.1);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            width: 10rem;
            background: rgba(255,255,255,0.85);
            backdrop-filter: blur(16px);
            border-radius: 0.5rem;
            border: 1px solid rgba(0,0,0,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            max-height: 24rem;
            overflow-y: auto;
            z-index: 100;
        }

        .dropdown-menu.hidden {
            display: none;
        }

        .dropdown-header {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            color: hsl(14,100%,60%);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .chapter-list {
            padding: 0.5rem;
        }

        .chapter-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: none;
            background: none;
            color: #374151;
            cursor: pointer;
            border-radius: 0.375rem;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }

        .chapter-item:hover {
            background: rgba(255,133,51,0.1);
            color: hsl(14,100%,60%);
        }

        .chapter-item.active {
            background: rgba(255,133,51,0.2);
            color: hsl(14,100%,60%);
        }

        .chapter-indicator {
            color: hsl(14,100%,60%);
            font-size: 0.75rem;
        }

        .video-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .main-video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }



        .slide-counter {
            position: absolute;
            top: 1rem;
            left: 1rem;
            z-index: 50;
            background: rgba(0,0,0,0.7);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            backdrop-filter: blur(12px);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .controls-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.7) 50%, transparent 100%);
            padding: 4rem 1rem 1rem;
            transition: all 0.3s ease;
            z-index: 40;
        }

        .controls-container.hidden {
            opacity: 0;
            transform: translateY(100%);
            pointer-events: none;
        }

        .controls-panel {
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(16px);
            border-radius: 1rem;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
        }

        .controls-left, .controls-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .control-button {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            cursor: pointer;
            padding: 0.75rem;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-button:hover:not(:disabled) {
            color: hsl(14,100%,60%);
            background: rgba(255,133,51,0.1);
            border-color: rgba(255,133,51,0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255,133,51,0.2);
        }

        .control-button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .play-button {
            background: linear-gradient(135deg, hsl(14,100%,60%) 0%, hsl(14,100%,55%) 100%) !important;
            color: white !important;
            padding: 1rem !important;
            border-radius: 50% !important;
            border: none !important;
            box-shadow: 0 6px 20px rgba(255,133,51,0.4);
        }

        .play-button:hover {
            background: linear-gradient(135deg, hsl(14,100%,55%) 0%, hsl(14,100%,50%) 100%) !important;
            box-shadow: 0 8px 25px rgba(255,133,51,0.5);
            transform: translateY(-2px) !important;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255,255,255,0.05);
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
        }

        .volume-button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }

        .volume-button:hover {
            background: rgba(255,133,51,0.1);
        }

        .volume-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 5rem;
            height: 0.25rem;
            border-radius: 0.125rem;
            outline: none;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(255,255,255,0.2);
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 1rem;
            height: 1rem;
            background: linear-gradient(135deg, hsl(14,100%,60%) 0%, hsl(14,100%,55%) 100%);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(255,133,51,0.5);
            transition: all 0.2s ease;
        }

        .volume-slider::-webkit-slider-thumb:hover {
            box-shadow: 0 0 12px rgba(255,133,51,0.7);
            transform: scale(1.1);
        }

        .volume-slider::-moz-range-thumb {
            width: 1rem;
            height: 1rem;
            background: linear-gradient(135deg, hsl(14,100%,60%) 0%, hsl(14,100%,55%) 100%);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 0 8px rgba(255,133,51,0.5);
            transition: all 0.2s ease;
        }

        .timeline-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            min-width: 12rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .timeline-container.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .timeline-time {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.7);
            min-width: 2.5rem;
            text-align: center;
        }

        .timeline-slider {
            -webkit-appearance: none;
            appearance: none;
            flex: 1;
            height: 0.25rem;
            border-radius: 0.125rem;
            background: rgba(255,255,255,0.2);
            outline: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .timeline-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 0.875rem;
            height: 0.875rem;
            background: linear-gradient(135deg, hsl(14,100%,60%) 0%, hsl(14,100%,55%) 100%);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(255,133,51,0.5);
            transition: all 0.2s ease;
        }

        .timeline-slider::-webkit-slider-thumb:hover {
            box-shadow: 0 0 12px rgba(255,133,51,0.7);
            transform: scale(1.1);
        }

        .timeline-slider::-moz-range-thumb {
            width: 0.875rem;
            height: 0.875rem;
            background: linear-gradient(135deg, hsl(14,100%,60%) 0%, hsl(14,100%,55%) 100%);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 0 8px rgba(255,133,51,0.5);
            transition: all 0.2s ease;
        }

        .fullscreen-button {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            cursor: pointer;
            padding: 0.75rem;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fullscreen-button:hover {
            color: hsl(14,100%,60%);
            background: rgba(255,133,51,0.1);
            border-color: rgba(255,133,51,0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255,133,51,0.2);
        }

        .loading-state {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(8px);
            z-index: 30;
        }

        .loading-spinner {
            width: 3rem;
            height: 3rem;
            border: 3px solid rgba(255,133,51,0.2);
            border-top: 3px solid hsl(14,100%,60%);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            text-align: center;
            color: white;
            font-size: 0.875rem;
            margin-top: 1rem;
        }

        .hidden {
            display: none;
        }

        /* Touch gesture visual feedback */
        .touch-feedback {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,133,51,0.1);
            border-radius: 50%;
            width: 4rem;
            height: 4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            transition: all 0.3s ease;
            z-index: 60;
            pointer-events: none;
        }

        .touch-feedback.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .touch-feedback svg {
            width: 2rem;
            height: 2rem;
            fill: hsl(14,100%,60%);
        }

        /* Fullscreen specific styles */
        .player-container:fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 9999;
        }

        .player-container:-webkit-full-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 9999;
        }

        .player-container:-moz-full-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 9999;
        }

        .player-container:-ms-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 9999;
        }

        /* Hide controls in fullscreen after timeout */
        .player-container.fullscreen-mode .controls-container {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .player-container.fullscreen-mode.controls-hidden .controls-container {
            opacity: 0;
            pointer-events: none;
            transform: translateY(100%);
        }

        .player-container.fullscreen-mode.controls-hidden .studio-branding {
            opacity: 0;
            pointer-events: none;
        }

        .player-container.fullscreen-mode.controls-hidden .slide-counter {
            opacity: 0;
            pointer-events: none;
        }

        /* Mobile touch zones for navigation */
        .touch-zone {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 30%;
            z-index: 35;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .touch-zone.left {
            left: 0;
        }

        .touch-zone.right {
            right: 0;
        }

        .touch-zone:active {
            background: rgba(255,133,51,0.05);
        }

        /* Mobile fullscreen arrows */
        .mobile-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 4rem;
            height: 4rem;
            background: rgba(0,0,0,0.7);
            border: 2px solid rgba(255,133,51,0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 45;
            transition: all 0.3s ease;
            backdrop-filter: blur(8px);
            opacity: 0;
            pointer-events: none;
        }

        .mobile-arrow.visible {
            opacity: 1;
            pointer-events: all;
        }

        .mobile-arrow.left {
            left: 1rem;
        }

        .mobile-arrow.right {
            right: 1rem;
        }

        .mobile-arrow:hover {
            background: rgba(255,133,51,0.2);
            border-color: rgba(255,133,51,0.8);
            transform: translateY(-50%) scale(1.1);
        }

        .mobile-arrow:active {
            transform: translateY(-50%) scale(0.95);
        }

        .mobile-arrow svg {
            width: 2rem;
            height: 2rem;
            fill: rgba(255,133,51,0.9);
        }

        .mobile-arrow.disabled {
            opacity: 0.3;
            pointer-events: none;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .controls-panel {
                flex-direction: row;
                gap: 0.5rem;
                padding: 1rem;
                flex-wrap: wrap;
            }
            
            .controls-left, .controls-right {
                flex: 1;
                justify-content: center;
            }
            
            .timeline-container {
                min-width: 100%;
                order: -1;
            }
            
            .volume-control {
                display: flex;
            }
            
            .studio-branding {
                top: 0.5rem;
                right: 0.5rem;
            }
            
            .slide-counter {
                top: 0.5rem;
                left: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="player-container" id="playerContainer">
        <!-- Studio branding -->
        <div class="studio-branding">
            <div class="studio-brand-block">
                <div class="studio-name">VAMPUCA AI</div>
            </div>
            <div class="dropdown-button-container">
                <button class="dropdown-button" id="dropdownButton">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 9l6 6 6-6"/>
                    </svg>
                </button>
                <div class="dropdown-menu hidden" id="dropdownMenu">
                    <div class="dropdown-header">Select Chapter</div>
                    <div class="chapter-list" id="chapterList"></div>
                </div>
            </div>
        </div>

        <!-- Slide counter -->
        <div class="slide-counter">
            <span id="slideCounter">1 / 21</span>
        </div>

        <!-- Touch zones for navigation -->
        <div class="touch-zone left" id="leftTouchZone"></div>
        <div class="touch-zone right" id="rightTouchZone"></div>

        <!-- Mobile fullscreen arrows -->
        <div class="mobile-arrow left" id="mobileLeftArrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
        </div>
        <div class="mobile-arrow right" id="mobileRightArrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 18l6-6-6-6"/>
            </svg>
        </div>

        <!-- Video container -->
        <div class="video-container" id="videoContainer">
            <video class="main-video" id="mainVideo" preload="auto" playsinline>
                <source src="" type="video/mp4">
            </video>
            
            <!-- Touch feedback -->
            <div class="touch-feedback" id="touchFeedback">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                </svg>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls-container" id="controlsContainer">
            <div class="controls-panel">
                <div class="controls-left">
                    <button class="control-button" id="prevButton">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5m7-7l-7 7 7 7"/>
                        </svg>
                    </button>
                    <button class="control-button play-button" id="playButton">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5,3 19,12 5,21"/>
                        </svg>
                    </button>
                    <button class="control-button" id="nextButton">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14m-7-7l7 7-7 7"/>
                        </svg>
                    </button>
                </div>
                
                <div class="timeline-container" id="timelineContainer">
                    <span class="timeline-time" id="currentTime">0:00</span>
                    <input type="range" class="timeline-slider" id="timelineSlider" min="0" max="100" value="0">
                    <span class="timeline-time" id="totalTime">0:00</span>
                </div>
                
                <div class="controls-right">
                    <div class="volume-control">
                        <button class="volume-button" id="volumeButton">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="11,5 6,9 2,9 2,15 6,15 11,19"/>
                                <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/>
                            </svg>
                        </button>
                        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
                    </div>
                    <button class="fullscreen-button" id="fullscreenButton">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Loading state -->
        <div class="loading-state hidden" id="loadingState">
            <div>
                <div class="loading-spinner"></div>
                <div class="loading-text">Loading...</div>
            </div>
        </div>
    </div>

    <script>
        // Application state
        let currentSlide = 0; // Start with title (0), then chapters 1-21, then end (22)
        let totalSlides = 23; // Title + 21 chapters + End
        let isPlaying = false;
        let isFullscreen = false;
        let controlsTimeout;
        
        // Touch gesture handling
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        let isTouching = false;
        
        // DOM elements
        const playerContainer = document.getElementById('playerContainer');
        const mainVideo = document.getElementById('mainVideo');
        const playButton = document.getElementById('playButton');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const slideCounter = document.getElementById('slideCounter');
        const timelineContainer = document.getElementById('timelineContainer');
        const timelineSlider = document.getElementById('timelineSlider');
        const currentTimeSpan = document.getElementById('currentTime');
        const totalTimeSpan = document.getElementById('totalTime');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumeButton = document.getElementById('volumeButton');
        const fullscreenButton = document.getElementById('fullscreenButton');
        const controlsContainer = document.getElementById('controlsContainer');
        const dropdownButton = document.getElementById('dropdownButton');
        const dropdownMenu = document.getElementById('dropdownMenu');
        const chapterList = document.getElementById('chapterList');
        const touchFeedback = document.getElementById('touchFeedback');
        const leftTouchZone = document.getElementById('leftTouchZone');
        const rightTouchZone = document.getElementById('rightTouchZone');
        const mobileLeftArrow = document.getElementById('mobileLeftArrow');
        const mobileRightArrow = document.getElementById('mobileRightArrow');
        const loadingState = document.getElementById('loadingState');

        // Video data with title, chapters, and end
        const videoData = [
            { title: "Title", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT_title.m4v" },
            { title: "Chapter 1", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT1.m4v" },
            { title: "Chapter 2", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT2.m4v" },
            { title: "Chapter 3", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT3.m4v" },
            { title: "Chapter 4", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT4.m4v" },
            { title: "Chapter 5", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT5.m4v" },
            { title: "Chapter 6", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT6.m4v" },
            { title: "Chapter 7", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT7.m4v" },
            { title: "Chapter 8", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT8.m4v" },
            { title: "Chapter 9", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT9.m4v" },
            { title: "Chapter 10", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT10.m4v" },
            { title: "Chapter 11", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT11.m4v" },
            { title: "Chapter 12", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT12.m4v" },
            { title: "Chapter 13", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT13.m4v" },
            { title: "Chapter 14", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT14.m4v" },
            { title: "Chapter 15", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT15.m4v" },
            { title: "Chapter 16", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT16.m4v" },
            { title: "Chapter 17", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT17.m4v" },
            { title: "Chapter 18", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT18.m4v" },
            { title: "Chapter 19", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT19.m4v" },
            { title: "Chapter 20", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT20.m4v" },
            { title: "Chapter 21", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT21.m4v" },
            { title: "End", videoUrl: "https://github.com/vampuca/vampuca_player/raw/main/KLKT_end.m4v" }
        ];

        // Load video frame instantly with auto-play
        function loadFrame(frameNumber) {
            if (frameNumber < 0 || frameNumber >= totalSlides) return;
            
            const frame = videoData[frameNumber];
            
            // Load video instantly
            mainVideo.src = frame.videoUrl;
            mainVideo.load();
            
            // Ensure video doesn't loop
            mainVideo.loop = false;
            
            // Auto-play when video is loaded
            mainVideo.addEventListener('loadeddata', function autoPlay() {
                if (mainVideo.readyState >= 2) {
                    // Try to enable sound on mobile
                    if (isMobile()) {
                        mainVideo.muted = false;
                        mainVideo.volume = 0.7;
                    }
                    playVideo();
                }
                mainVideo.removeEventListener('loadeddata', autoPlay);
            });
            
            // Update UI immediately
            updateFrameInfo();
        }

        // Update frame information
        function updateFrameInfo() {
            const frame = videoData[currentSlide];
            // Show frame counter in format like "1/23", "Title/23", etc.
            slideCounter.textContent = `${frame.title}/${totalSlides}`;
            updateNavigationButtons();
            updateFrameList();
        }

        // Update navigation buttons
        function updateNavigationButtons() {
            // Title frame: only forward button (hide play and back buttons)
            if (currentSlide === 0) {
                prevButton.style.display = 'none';
                playButton.style.display = 'none';
                nextButton.style.display = 'flex';
                nextButton.disabled = false;
                mobileLeftArrow.classList.add('disabled');
                mobileRightArrow.classList.remove('disabled');
            }
            // End frame: only back button and play button (hide forward button)
            else if (currentSlide === totalSlides - 1) {
                prevButton.style.display = 'flex';
                playButton.style.display = 'flex';
                nextButton.style.display = 'none';
                prevButton.disabled = false;
                mobileLeftArrow.classList.remove('disabled');
                mobileRightArrow.classList.add('disabled');
            }
            // Regular frames: all buttons visible
            else {
                prevButton.style.display = 'flex';
                playButton.style.display = 'flex';
                nextButton.style.display = 'flex';
                prevButton.disabled = false;
                nextButton.disabled = false;
                mobileLeftArrow.classList.remove('disabled');
                mobileRightArrow.classList.remove('disabled');
            }
        }

        // Update frame list with simple numbering
        function updateFrameList() {
            chapterList.innerHTML = '';
            videoData.forEach((frame, index) => {
                const button = document.createElement('button');
                button.className = `chapter-item ${index === currentSlide ? 'active' : ''}`;
                button.innerHTML = `
                    <span>${frame.title}</span>
                    <span class="chapter-indicator">${index === currentSlide ? '●' : ''}</span>
                `;
                button.addEventListener('click', () => {
                    goToFrame(index);
                    dropdownMenu.classList.add('hidden');
                });
                chapterList.appendChild(button);
            });
        }

        // Navigation functions - with auto-play after arrow click
        function goToFrame(frameNumber) {
            if (frameNumber >= 0 && frameNumber < totalSlides) {
                currentSlide = frameNumber;
                loadFrame(currentSlide);
                // Auto-play video after loading
                setTimeout(() => {
                    if (mainVideo.readyState >= 2) {
                        playVideo();
                    }
                }, 100);
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                goToFrame(currentSlide - 1);
                showTouchFeedback('left');
            }
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                goToFrame(currentSlide + 1);
                showTouchFeedback('right');
            }
        }

        // Touch feedback
        function showTouchFeedback(direction) {
            const svg = touchFeedback.querySelector('svg');
            if (direction === 'left') {
                svg.style.transform = 'rotate(180deg)';
            } else {
                svg.style.transform = 'rotate(0deg)';
            }
            
            touchFeedback.classList.add('show');
            setTimeout(() => {
                touchFeedback.classList.remove('show');
            }, 300);
        }

        // Fullscreen functionality
        function toggleFullscreen() {
            if (!isFullscreen) {
                enterFullscreen();
            } else {
                exitFullscreen();
            }
        }

        function enterFullscreen() {
            const element = playerContainer;
            
            if (element.requestFullscreen) {
                element.requestFullscreen();
            } else if (element.webkitRequestFullscreen) {
                element.webkitRequestFullscreen();
            } else if (element.mozRequestFullScreen) {
                element.mozRequestFullScreen();
            } else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
            }
            
            // Fullscreen handling for all devices
            document.body.style.overflow = 'hidden';
            playerContainer.classList.add('fullscreen-mode');
            
            // Auto-hide controls after 3 seconds
            resetControlsTimeout();
            
            // Show touch zones and mobile arrows for mobile devices
            if (isMobile()) {
                leftTouchZone.style.display = 'block';
                rightTouchZone.style.display = 'block';
                mobileLeftArrow.classList.add('visible');
                mobileRightArrow.classList.add('visible');
            }
        }

        function exitFullscreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
            
            // Cleanup for all devices
            document.body.style.overflow = '';
            playerContainer.classList.remove('fullscreen-mode', 'controls-hidden');
            
            // Hide touch zones and mobile arrows for mobile devices
            if (isMobile()) {
                leftTouchZone.style.display = 'none';
                rightTouchZone.style.display = 'none';
                mobileLeftArrow.classList.remove('visible');
                mobileRightArrow.classList.remove('visible');
            }
            
            clearTimeout(controlsTimeout);
        }

        // Mobile detection
        function isMobile() {
            return window.matchMedia('(max-width: 768px)').matches || 
                   /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        // Controls timeout for fullscreen
        function resetControlsTimeout() {
            clearTimeout(controlsTimeout);
            playerContainer.classList.remove('controls-hidden');
            
            if (isFullscreen) {
                controlsTimeout = setTimeout(() => {
                    playerContainer.classList.add('controls-hidden');
                }, 3000);
            }
        }

        // Touch event handlers
        function handleTouchStart(e) {
            if (!isFullscreen) return;
            
            isTouching = true;
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            
            // Reset controls timeout on touch
            resetControlsTimeout();
        }

        function handleTouchMove(e) {
            if (!isFullscreen || !isTouching) return;
            
            e.preventDefault();
            touchEndX = e.touches[0].clientX;
            touchEndY = e.touches[0].clientY;
        }

        function handleTouchEnd(e) {
            if (!isFullscreen || !isTouching) return;
            
            isTouching = false;
            
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            const minSwipeDistance = 50;
            
            // Check if it's a horizontal swipe
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                if (deltaX > 0) {
                    // Swipe right - go to previous slide
                    previousSlide();
                } else {
                    // Swipe left - go to next slide
                    nextSlide();
                }
            } else {
                // Tap to show/hide controls
                if (Math.abs(deltaX) < 10 && Math.abs(deltaY) < 10) {
                    if (playerContainer.classList.contains('controls-hidden')) {
                        resetControlsTimeout();
                    } else {
                        playerContainer.classList.add('controls-hidden');
                    }
                }
            }
        }

        // Play/pause functionality for video
        function togglePlayPause() {
            if (isPlaying) {
                pauseVideo();
            } else {
                playVideo();
            }
        }

        function playVideo() {
            mainVideo.play();
            isPlaying = true;
            playButton.innerHTML = '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>';
        }

        function pauseVideo() {
            mainVideo.pause();
            isPlaying = false;
            playButton.innerHTML = '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5,3 19,12 5,21"/></svg>';
        }

        // Format time display
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Event listeners
        playButton.addEventListener('click', togglePlayPause);
        prevButton.addEventListener('click', previousSlide);
        nextButton.addEventListener('click', nextSlide);
        fullscreenButton.addEventListener('click', toggleFullscreen);

        // Touch zone event listeners
        leftTouchZone.addEventListener('click', previousSlide);
        rightTouchZone.addEventListener('click', nextSlide);

        // Mobile arrow event listeners
        mobileLeftArrow.addEventListener('click', previousSlide);
        mobileRightArrow.addEventListener('click', nextSlide);

        // Touch events for swipe navigation
        playerContainer.addEventListener('touchstart', handleTouchStart, { passive: false });
        playerContainer.addEventListener('touchmove', handleTouchMove, { passive: false });
        playerContainer.addEventListener('touchend', handleTouchEnd, { passive: false });

        // Video container click to toggle play/pause
        mainVideo.addEventListener('click', (e) => {
            if (!isFullscreen) {
                togglePlayPause();
            }
        });

        // Video events
        mainVideo.addEventListener('loadedmetadata', () => {
            timelineSlider.max = mainVideo.duration;
            totalTimeSpan.textContent = formatTime(mainVideo.duration);
            timelineContainer.classList.add('visible');
        });

        mainVideo.addEventListener('timeupdate', () => {
            if (mainVideo.duration) {
                timelineSlider.value = mainVideo.currentTime;
                currentTimeSpan.textContent = formatTime(mainVideo.currentTime);
            }
        });

        // Video ended - NO auto-advancement, just stop
        mainVideo.addEventListener('ended', () => {
            pauseVideo();
        });

        // Timeline slider for video
        timelineSlider.addEventListener('input', () => {
            mainVideo.currentTime = timelineSlider.value;
        });

        // Volume control
        volumeSlider.addEventListener('input', () => {
            mainVideo.volume = volumeSlider.value / 100;
        });

        volumeButton.addEventListener('click', () => {
            if (mainVideo.muted) {
                mainVideo.muted = false;
                volumeButton.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11,5 6,9 2,9 2,15 6,15 11,19"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>';
            } else {
                mainVideo.muted = true;
                volumeButton.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11,5 6,9 2,9 2,15 6,15 11,19"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>';
            }
        });

        // Dropdown menu
        dropdownButton.addEventListener('click', () => {
            dropdownMenu.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!dropdownButton.contains(e.target) && !dropdownMenu.contains(e.target)) {
                dropdownMenu.classList.add('hidden');
            }
        });

        // Fullscreen change events
        document.addEventListener('fullscreenchange', () => {
            isFullscreen = !!document.fullscreenElement;
            if (!isFullscreen) {
                exitFullscreen();
            }
        });

        document.addEventListener('webkitfullscreenchange', () => {
            isFullscreen = !!document.webkitFullscreenElement;
            if (!isFullscreen) {
                exitFullscreen();
            }
        });

        document.addEventListener('mozfullscreenchange', () => {
            isFullscreen = !!document.mozFullScreenElement;
            if (!isFullscreen) {
                exitFullscreen();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            switch (e.key) {
                case ' ':
                    e.preventDefault();
                    togglePlayPause();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    previousSlide();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    nextSlide();
                    break;
                case 'f':
                case 'F':
                    e.preventDefault();
                    toggleFullscreen();
                    break;
                case 'Escape':
                    if (isFullscreen) {
                        exitFullscreen();
                    }
                    break;
            }
        });

        // Mouse movement and touch events in fullscreen
        playerContainer.addEventListener('mousemove', () => {
            if (isFullscreen) {
                resetControlsTimeout();
            }
        });

        playerContainer.addEventListener('touchstart', () => {
            if (isFullscreen) {
                resetControlsTimeout();
            }
        });

        // Initialize the video player
        function initializePlayer() {
            // Load first frame (title) instantly
            loadFrame(currentSlide);
            
            // Initialize frame list
            updateFrameList();
            
            // Hide touch zones and mobile arrows initially (shown only in fullscreen)
            leftTouchZone.style.display = 'none';
            rightTouchZone.style.display = 'none';
            mobileLeftArrow.classList.remove('visible');
            mobileRightArrow.classList.remove('visible');
            
            // Initialize volume
            mainVideo.volume = 0.7;
            volumeSlider.value = 70;
        }

        // Start the application
        initializePlayer();
    </script>
</body>
</html>
